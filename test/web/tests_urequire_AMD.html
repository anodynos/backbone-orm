<!-- runs from _build/test/web -->
<!-- *forked* from tests_amd.html -->
<!DOCTYPE HTML>
<html>
<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<head>
  <title>Backbone-ORM-uRequire-AMD</title>
  <script src="../../../bower_components/requirejs/require.js"></script>
  <script>
    require.config({

        baseUrl:"../../UMD",

        paths: {
          'underscore': "../../bower_components/underscore/underscore",
          'backbone': "../../bower_components/backbone/backbone",
          'moment': "../../bower_components/moment/moment",
          'inflection': "../../bower_components/inflection/lib/inflection",
          'stream': "../../stream",
          'backbone-orm': "index"
        },

        shim: {
          backbone: { deps: ['underscore'], exports: "Backbone"},
          underscore: { deps: [], exports: "_"}
        }
    });

    require(['underscore', 'backbone', 'stream', 'backbone-orm'], function(_, Backbone, stream, BackboneORM) {
      //var Backbone = window.Backbone; // Better to load as AMD dep instead of `window`
      var Test = Backbone.Model.extend({
        urlRoot: '/api/tests',
        model_name: 'Test'
      });
      Test.prototype.sync = BackboneORM.sync(Test);

      var test = new Test({name: 'Bob'});
      test.save(function(err){
        Test.stream()
          .on('data', function(model){console.log("Model: " + model.get('name'));})
          .on('error', function(err){ console.log("An error is NOT expected: " + err); });
      });
    });
  </script>
</head>
